From e7fb4d1d059d20d27c903d1b8abcecf486888628 Mon Sep 17 00:00:00 2001
From: Michael McAuliffe <michael.e.mcauliffe@gmail.com>
Date: Wed, 3 Aug 2022 20:26:42 -0700
Subject: [PATCH] Update CMake to skip installation of executables on Windows
 pending OpenFst #27

---
 cmake/third_party/openfst.cmake | 61 ++++-----------------------------
 1 file changed, 6 insertions(+), 55 deletions(-)

diff --git a/cmake/third_party/openfst.cmake b/cmake/third_party/openfst.cmake
index ccd2cd7..a134b2a 100644
--- a/cmake/third_party/openfst.cmake
+++ b/cmake/third_party/openfst.cmake
@@ -17,61 +17,12 @@ if(NOT openfst_POPULATED)
 
     if(CONDA_ROOT)
 
-        if(MSVC)
-            install(TARGETS fstarcsort fstclosure fstcompile fstcompose fstconcat fstconnect fstconvert fstdeterminize
-                            fstdifference fstdisambiguate fstdraw fstencode fstepsnormalize fstequal fstequivalent
-                            fstinfo fstintersect fstinvert fstisomorphic fstmap fstminimize fstprint fstproject fstprune
-                            fstpush fstrandgen fstrelabel fstreplace fstreverse fstreweight fstrmepsilon fstshortestdistance
-                            fstshortestpath fstsymbols fstsynchronize fsttopsort fstunion
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-            install(TARGETS farcompilestrings farcreate farequal farextract farinfo farisomorphic farprintstrings
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-            install(TARGETS fstlinear fstloglinearapply
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-            install(TARGETS mpdtcompose mpdtexpand mpdtinfo mpdtreverse
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-            install(TARGETS pdtcompose pdtexpand pdtinfo pdtreplace pdtreverse pdtshortestpath
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-            install(TARGETS fstspecial
-            RUNTIME
-                DESTINATION ${CMAKE_INSTALL_BINDIR}
-                COMPONENT kaldi
-            )
-
-            install(DIRECTORY ${openfst_SOURCE_DIR}/src/include/ DESTINATION include/
-            COMPONENT kaldi
-                    FILES_MATCHING PATTERN "*.h")
-
-            install(TARGETS fst
-                    EXPORT kaldi-targets
-                    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT kaldi
-                    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT kaldi NAMELINK_SKIP
-                    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} COMPONENT kaldi)
-        else()
-
-            install(TARGETS fst
-                    LIBRARY
-                        DESTINATION ${CMAKE_INSTALL_LIBDIR}
-                        COMPONENT kaldi
-                        NAMELINK_SKIP # Link to so with version to avoid conflicts with OpenFst 1.8.1 on conda
-                    )
-
-        endif()
+        install(TARGETS fst
+                LIBRARY
+                    DESTINATION ${CMAKE_INSTALL_LIBDIR}
+                    COMPONENT kaldi
+                    NAMELINK_SKIP # Link to so with version to avoid conflicts with OpenFst 1.8.2 on conda
+                )
 
     else() # Original functionality
 
-- 
2.35.3

